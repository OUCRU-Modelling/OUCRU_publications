<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Handling OUCRU publications</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="fullcontent">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Handling OUCRU publications</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Packages needed:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rcrossref)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Reading the year 2022 from OUCRU excel file as an example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pubs22 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"2022 OUCRU Publications (Mar20).xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>pubs22</code> contains the data from the first sheet of the excel file (here showing only the first 16 columns of the first 10 publications as an example):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pubs22</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 134 × 34
     No. Author         Title Journal Ref   `Published date`    PMID PMCID DOI  
   &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
 1     1 Nguyen Van Vi… Immu… Am J T… 2022… 44568             3.50e7 &lt;NA&gt;  10.4…
 2     2 Mark S Butler… Anal… Antimi… 2022… 44571             3.50e7 &lt;NA&gt;  10.1…
 3     3 Nothando Ngwe… A ne… Wellco… 2022… 44602            NA      &lt;NA&gt;  10.1…
 4     4 Duc Minh Tran… Digi… J Med … 2022… 44601             3.51e7 &lt;NA&gt;  10.2…
 5     5 Ton That Than… SARS… J Infe… 2022… 44574             3.50e7 PMC8… 10.1…
 6     6 RECOVERY Coll… Casi… Lancet. 2022… 44604             3.52e7 PMC8… 10.1…
 7     7 Antimicrobial… Glob… Lancet. 2022… 44604             3.51e7 &lt;NA&gt;  10.1…
 8     8 Pisani L, Alg… Geoe… Lancet… 2022… 44593             3.49e7 PMC8… 10.1…
 9     9 Damien K. Min… Appl… PLOS D… &lt;NA&gt;  44579            NA      &lt;NA&gt;  10.1…
10    10 Shah JA, Warr… REL … J Immu… 2022… 44617             3.52e7 &lt;NA&gt;  10.4…
# ℹ 124 more rows
# ℹ 25 more variables: `Lead or collaborator` &lt;chr&gt;, Topic &lt;chr&gt;, Group &lt;chr&gt;,
#   `Web link` &lt;chr&gt;, `Qualitative Research findings` &lt;chr&gt;,
#   `Primary research findings` &lt;chr&gt;, Editorial &lt;chr&gt;, Review &lt;chr&gt;,
#   `Book chapter` &lt;lgl&gt;, `Cost-effectiveness Publication` &lt;chr&gt;,
#   `Describing, or modelling, disease burden` &lt;chr&gt;,
#   `Defining or describing disease control strategies` &lt;chr&gt;, …</code></pre>
</div>
</div>
<p>From <code>pubs22</code> we want to extract the DOIs:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dois <span class="ot">&lt;-</span> <span class="fu">pull</span>(pubs22, <span class="st">"DOI"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>which looks like this (just showing the first few DOIs as an example):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dois)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "10.4269/ajtmh.21-0849"            "10.1128/AAC.01991-21"            
[3] "10.12688/wellcomeopenres.17548.1" "10.2196/32392"                   
[5] "10.1016/j.jinf.2022.01.010"       "10.1016/S0140-6736(22)00163-5"   </code></pre>
</div>
</div>
<p>Then you can use this list of DOIs to query the complete information of each publication through <a href="https://www.crossref.org">Crossref</a> online:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>p22 <span class="ot">&lt;-</span> <span class="fu">cr_works</span>(dois)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can see the amazing quantity of information that is available for each publication. Here a full list of the variables (no less than 36!):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(p22<span class="sc">$</span>data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "container.title"        "created"                "deposited"             
 [4] "published.print"        "doi"                    "indexed"               
 [7] "issn"                   "issue"                  "issued"                
[10] "member"                 "page"                   "prefix"                
[13] "publisher"              "score"                  "source"                
[16] "reference.count"        "references.count"       "is.referenced.by.count"
[19] "subject"                "title"                  "type"                  
[22] "url"                    "volume"                 "abstract"              
[25] "author"                 "link"                   "license"               
[28] "alternative.id"         "update.policy"          "language"              
[31] "short.container.title"  "assertion"              "reference"             
[34] "published.online"       "funder"                 "archive"               
[37] "update_to"             </code></pre>
</div>
</div>
<p>This is basically what it looks like (again, showing here only the first 8 fields of the first 10 publications):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>p22<span class="sc">$</span>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 118 × 37
   container.title   created deposited published.print doi   indexed issn  issue
   &lt;chr&gt;             &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;
 1 The American Jou… 2022-0… 2022-02-… 2022-02-02      10.4… 2023-0… 0002… 2    
 2 Antimicrobial Ag… 2022-0… 2022-03-… 2022-03-15      10.1… 2023-0… 0066… 3    
 3 Wellcome Open Re… 2022-0… 2022-03-… &lt;NA&gt;            10.1… 2022-0… 2398… &lt;NA&gt; 
 4 Journal of Medic… 2022-0… 2022-02-… &lt;NA&gt;            10.2… 2023-0… 1438… 2    
 5 Journal of Infec… 2022-0… 2022-07-… 2022-04         10.1… 2022-0… 0163… 4    
 6 The Lancet        2022-0… 2023-03-… 2022-02         10.1… 2023-0… 0140… 10325
 7 The Lancet        2022-0… 2023-03-… 2022-02         10.1… 2023-0… 0140… 10325
 8 The Lancet Globa… 2021-1… 2022-01-… 2022-02         10.1… 2023-0… 2214… 2    
 9 PLOS Digital Hea… 2022-0… 2022-01-… &lt;NA&gt;            10.1… 2023-0… 2767… 1    
10 The Journal of I… 2022-0… 2023-01-… 2022-03-15      10.4… 2023-0… 0022… 6    
# ℹ 108 more rows
# ℹ 29 more variables: issued &lt;chr&gt;, member &lt;chr&gt;, page &lt;chr&gt;, prefix &lt;chr&gt;,
#   publisher &lt;chr&gt;, score &lt;chr&gt;, source &lt;chr&gt;, reference.count &lt;chr&gt;,
#   references.count &lt;chr&gt;, is.referenced.by.count &lt;chr&gt;, subject &lt;chr&gt;,
#   title &lt;chr&gt;, type &lt;chr&gt;, url &lt;chr&gt;, volume &lt;chr&gt;, abstract &lt;chr&gt;,
#   author &lt;list&gt;, link &lt;list&gt;, license &lt;list&gt;, alternative.id &lt;chr&gt;,
#   update.policy &lt;chr&gt;, language &lt;chr&gt;, short.container.title &lt;chr&gt;, …</code></pre>
</div>
</div>
<p>Some of these variables are very interesting, such as <code>is.referenced.by.count</code> that tells you how often the publication has been cited as of today! This is a key metric. Also, interestingly, there is a variable named <code>subject</code> that gives you the broad topic of the publication. There is also a <code>funder</code> variable that tells you what funded the study. For example, for the 3rd publication in this list we can see that it is Wellcome:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>p22<span class="sc">$</span>data[<span class="dv">3</span>, <span class="st">"funder"</span>][[<span class="dv">1</span>]][[<span class="dv">1</span>]]<span class="sc">$</span>name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Wellcome Trust"</code></pre>
</div>
</div>
<p>But probably more interesting to you is what relates to the authors information, where given and family names are (1) full and (2) clearly distinguished, and the affiliations are given too. Here an example for the first publication:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>p22<span class="sc">$</span>data[<span class="dv">1</span>, <span class="st">"author"</span>][[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 24 × 6
   given    family sequence affiliation.name affiliation1.name affiliation2.name
   &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;             &lt;chr&gt;            
 1 Nguyen … Chau   first    1Hospital for T… &lt;NA&gt;              &lt;NA&gt;             
 2 Lam Anh  Nguyet additio… 2Oxford Univers… &lt;NA&gt;              &lt;NA&gt;             
 3 Nguyen … Truong additio… 1Hospital for T… &lt;NA&gt;              &lt;NA&gt;             
 4 Le Mau   Toan   additio… 1Hospital for T… &lt;NA&gt;              &lt;NA&gt;             
 5 Nguyen … Dung   additio… 1Hospital for T… &lt;NA&gt;              &lt;NA&gt;             
 6 Le Manh  Hung   additio… 1Hospital for T… &lt;NA&gt;              &lt;NA&gt;             
 7 Mai Tha… Nhan   additio… 1Hospital for T… &lt;NA&gt;              &lt;NA&gt;             
 8 Dinh Ng… Man    additio… 1Hospital for T… &lt;NA&gt;              &lt;NA&gt;             
 9 Nghiem … Ngoc   additio… 1Hospital for T… &lt;NA&gt;              &lt;NA&gt;             
10 Huynh P… Thao   additio… 1Hospital for T… &lt;NA&gt;              &lt;NA&gt;             
# ℹ 14 more rows</code></pre>
</div>
</div>
<p>With the full given and family names here I believe you can fairly easily construct the hash table that will ensure consistency. Indeed, the most common inconsistency that happens with Vietnamese authors is that they sometimes switch given and family names. So, you can construct the hash table by trying both options, which takes no time with a bit of computer code. One point to note is that even if on the publication itself initials are usually used for the given names, in the actually data bases such as the one that we queried here (<a href="https://www.crossref.org">Crossref</a>), you’ll always find the full names. Hence, with the DOIs and a little bit of code you can actually retrieve much more information than what is in the excel file that you sent me, in a tiny fraction of the time that it took to build this excel file in the first place! That’s why I’m basically recommending OUCRU to forget about this excel file and just make sure they have the DOI which is the only thing that really matters.</p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>